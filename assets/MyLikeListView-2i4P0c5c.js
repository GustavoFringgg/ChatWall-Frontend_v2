import{u as x,N as C,_ as B}from"./NavbarCard-DT8qPjH1.js";import{d as D,_ as A}from"./LoadingOverlay-B5bDGRwL.js";import{r as m,j as U,f as _,c as a,d as h,a as s,F as p,p as N,s as M,i as V,o as n,t as f,h as Y}from"./index-CVYQRrmA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={key:0},z={class:"container"},S={class:"row mt-4"},T={class:"col-lg-9"},F={key:0},H={key:1},I={class:"col-12"},E={class:"card p-3 shadow-sm border border-3 border-dark"},P={class:"d-flex justify-content-between align-items-center"},R={class:"d-flex align-items-center"},q=["src"],G={class:"ms-3"},J={class:"mb-1 fw-bold"},K={class:"text-muted mb-0"},O=["onClick"],Q=["onClick"],b="http://localhost:3000",ts={__name:"MyLikeListView",setup(W){const r=m(""),{showAlert:c}=Y(),l=V(),d=x(),u=m(!0),i=m(),y=async()=>{r.value=document.cookie.replace(/(?:(?:^|.*;\s*)Token\s*\=\s*([^;]*).*$)|^.*$/,"$1"),r.value||(c("請登入","error"),l.push({path:"/"}));try{const t=await _.get(`${b}/users/checkout`,{headers:{Authorization:`Bearer ${r.value}`}})}catch(t){console.log(t)}};U(async()=>{try{await y(),d.loadUserInfo(),r.value?await v():l.push({path:"/"})}finally{u.value=!1}});const k=()=>{history.back()},w=t=>{l.push(`/certainpost/${t}`)},v=async()=>{const t=await _.get(`${b}/users/getLikeList`,{headers:{Authorization:`Bearer ${d.token}`}});console.log("如果沒有喜歡的文章的話",t.data.likeList),i.value=t.data.likeList.map(e=>({...e,formattedDate:D(e.createdAt).format("YYYY-MM-DD HH:mm")})),console.log("沒有喜歡文章的getUserLikeListData",i.value)},$=async t=>{try{const e=await _.delete(`${b}/posts/${t}/unlikes`,{headers:{Authorization:`Bearer ${d.token}`}});v(),c("已取消讚","success",1500)}catch(e){c(`${e.response.data.message}`,"error",2e3)}};return(t,e)=>{var g;return n(),a(p,null,[h(A,{"is-loading":u.value},null,8,["is-loading"]),u.value?M("",!0):(n(),a("div",j,[h(C),s("div",z,[s("div",S,[s("main",T,[(g=i.value)!=null&&g.length?(n(),a("div",H,[s("div",{class:"row"},[s("div",{class:"col text-center relative"},[s("button",{class:"btn btn-success rounded-3 mb-2 absolute",onClick:k},e[2]||(e[2]=[s("i",{class:"bi bi-arrow-left"},null,-1)])),e[3]||(e[3]=s("h2",{class:"fw-bold"},"您按讚的文章",-1))])]),(n(!0),a(p,null,N(i.value,o=>(n(),a("div",{class:"row mt-2",key:o._id},[s("div",I,[s("div",E,[s("div",P,[s("div",R,[s("img",{src:o.user.photo,alt:"用戶頭像",class:"rounded-circle border",style:{width:"50px",height:"50px"}},null,8,q),s("div",G,[s("p",J,f(o.user.name),1),s("p",K,"發文時間："+f(o.formattedDate),1)])]),s("div",null,[s("button",{class:"btn btn-outline-success btn-sm me-1",onClick:L=>w(o._id)}," 查看貼文 ",8,O),s("button",{class:"btn btn-outline-danger btn-sm",onClick:L=>$(o._id)}," 取消按讚 ",8,Q)])])])])]))),128))])):(n(),a("div",F,[s("div",{class:"container p-0"},[s("button",{class:"btn btn-success rounded-3 mb-2",onClick:k},e[0]||(e[0]=[s("i",{class:"bi bi-arrow-left"},null,-1)]))]),e[1]||(e[1]=s("div",{class:"custom-card border border-3 border-dark"},[s("div",{class:"card-content"},"目前沒有按讚的貼文，趕快按讚吧！")],-1))]))]),h(B)])])]))],64)}}};export{ts as default};
