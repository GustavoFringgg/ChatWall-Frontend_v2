import{u as L,N as C,_ as F}from"./NavbarCard-CL5TzJ4Z.js";import{_ as B,d as D}from"./LoadingOverlay-D_KNf4AH.js";import{r as _,j as U,c as a,d as m,a as s,F as f,p as A,s as M,i as N,f as h,o as r,t as p,h as V}from"./index-DIfrOW7X.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={key:0},z={class:"container"},I={class:"row mt-4"},S={class:"col-lg-9"},T={key:0},H={key:1},E={class:"col-12"},P={class:"card p-3 shadow-sm border border-3 border-dark"},R={class:"d-flex justify-content-between align-items-center"},q={class:"d-flex align-items-center"},G=["src"],J={class:"ms-3"},K={class:"mb-1 fw-bold"},O={class:"text-muted mb-0"},Q=["onClick"],W=["onClick"],b="http://localhost:3000",X={__name:"MyFollowListView",setup(Z){const l=_(""),{showAlert:i}=V(),d=N(),c=L(),u=_(!0),n=_(),w=async()=>{l.value=document.cookie.replace(/(?:(?:^|.*;\s*)Token\s*\=\s*([^;]*).*$)|^.*$/,"$1"),l.value||(i("請登入","error"),d.push({path:"/"}));try{const t=await h.get(`${b}/users/checkout`,{headers:{Authorization:`Bearer ${l.value}`}})}catch(t){console.log(t)}},k=async()=>{const t=await h.get(`${b}/users/getFollowingList`,{headers:{Authorization:`Bearer ${c.token}`}});n.value=t.data.followingList.map(e=>({...e,formattedDate:D(e.createdAt).format("YYYY-MM-DD HH:mm")})),console.log("getUserFollowListData.value",n.value)},y=async t=>{try{const e=await h.delete(`${b}/users/${t}/unfollow`,{headers:{Authorization:`Bearer ${c.token}`}});n.value=e.data.followingList,c.following.length-=1,i("已取消追蹤","success",2e3)}catch(e){i(`${e.response.data.message}`,"error",2e3)}};U(async()=>{try{await w(),c.loadUserInfo(),l.value?await k():d.push({path:"/"})}catch(t){console.log(t)}finally{u.value=!1}});const $=t=>{d.push(`/otherpost/${t}`)},v=()=>{history.back()};return(t,e)=>{var g;return r(),a(f,null,[m(B,{"is-loading":u.value},null,8,["is-loading"]),u.value?M("",!0):(r(),a("div",j,[m(C),s("div",z,[s("div",I,[s("main",S,[(g=n.value)!=null&&g.length?(r(),a("div",H,[s("div",{class:"row"},[s("div",{class:"col text-center relative"},[s("button",{class:"btn btn-success rounded-3 mb-2 absolute",onClick:v},e[2]||(e[2]=[s("i",{class:"bi bi-arrow-left"},null,-1)])),e[3]||(e[3]=s("h2",{class:"fw-bold"},"您追蹤的名單",-1))])]),(r(!0),a(f,null,A(n.value,o=>(r(),a("div",{class:"row mt-2",key:o._id},[s("div",E,[s("div",P,[s("div",R,[s("div",q,[s("img",{src:o.user.photo,alt:"用戶頭像",class:"rounded-circle border",style:{width:"50px",height:"50px"}},null,8,G),s("div",J,[s("p",K,p(o.user.name),1),s("p",O,"追蹤時間："+p(o.formattedDate),1)])]),s("div",null,[s("button",{class:"btn btn-outline-success btn-sm me-1",onClick:x=>$(o.user._id)}," 查看個人資料 ",8,Q),s("button",{class:"btn btn-outline-danger btn-sm",onClick:x=>y(o.user._id)}," 取消追蹤 ",8,W)])])])])]))),128))])):(r(),a("div",T,[s("div",{class:"container p-0"},[s("button",{class:"btn btn-success rounded-3 mb-2",onClick:v},e[0]||(e[0]=[s("i",{class:"bi bi-arrow-left"},null,-1)]))]),e[1]||(e[1]=s("div",{class:"custom-card border border-3 border-dark"},[s("div",{class:"card-content"},"目前沒有追蹤的對象，趕快追蹤一個人吧！")],-1))]))]),m(F)])])]))],64)}}},as=Y(X,[["__scopeId","data-v-c22c4fd8"]]);export{as as default};
